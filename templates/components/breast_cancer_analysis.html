<!-- Breast Cancer Analysis Tab -->
<div x-show="isActiveTab('breast-cancer')" class="space-y-6">
  <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6">
    <div class="flex items-center justify-between mb-6">
      <div>
        <h2 class="text-2xl font-bold text-gray-900">Breast Cancer Analysis</h2>
        <p class="text-gray-600 mt-1">AI-powered risk assessment using the Wisconsin dataset</p>
      </div>
      <a href="{{ url_for('breast_cancer_analysis') }}" 
         class="bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors">
        Start New Analysis
      </a>
    </div>

    <!-- Recent Predictions -->
    <div class="mb-6">
      <div class="flex items-center justify-between mb-4">
        <h3 class="text-lg font-semibold text-gray-900">Recent Predictions</h3>
        <button id="dashboard-refresh-predictions" 
          class="text-blue-600 hover:text-blue-800 text-sm font-medium">
          Refresh
        </button>
      </div>
      <div id="dashboard-predictions-container">
        <div class="text-center py-4 text-gray-500">
          <p>Loading predictions...</p>
        </div>
      </div>
    </div>

    <!-- Quick Stats -->
    <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
      <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 text-center">
        <div class="text-2xl font-bold text-blue-800">3</div>
        <div class="text-sm text-gray-600">Total Analyses</div>
      </div>
      <div class="bg-green-50 border border-green-200 rounded-lg p-4 text-center">
        <div class="text-2xl font-bold text-green-800">100%</div>
        <div class="text-sm text-gray-600">Benign Results</div>
      </div>
      <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4 text-center">
        <div class="text-2xl font-bold text-yellow-800">87.3%</div>
        <div class="text-sm text-gray-600">Avg Confidence</div>
      </div>
      <div class="bg-purple-50 border border-purple-200 rounded-lg p-4 text-center">
        <div class="text-2xl font-bold text-purple-800">Low</div>
        <div class="text-sm text-gray-600">Risk Level</div>
      </div>
    </div>

    <!-- Information Cards -->
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
      <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
        <h4 class="font-semibold text-gray-900 mb-2">About the Wisconsin Dataset</h4>
        <p class="text-sm text-gray-600">
          Our AI model is trained on the renowned Breast Cancer Wisconsin (Diagnostic) dataset, 
          which contains 569 samples with 30 features each. This dataset is widely used in 
          medical research and provides highly accurate predictions.
        </p>
      </div>
      
      <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
        <h4 class="font-semibold text-gray-900 mb-2">Model Accuracy</h4>
        <p class="text-sm text-gray-600">
          Our Random Forest model achieves over 95% accuracy on the Wisconsin dataset. 
          The model analyzes 30 different features including radius, texture, perimeter, 
          area, and other cellular characteristics to make predictions.
        </p>
      </div>
    </div>

    <!-- Action Buttons -->
    <div class="mt-6 flex flex-col sm:flex-row gap-4">
      <a href="{{ url_for('breast_cancer_analysis') }}" 
         class="flex-1 bg-blue-600 text-white px-6 py-3 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors text-center">
        Start New Analysis
      </a>
      <button 
         class="flex-1 bg-gray-100 text-gray-700 px-6 py-3 rounded-md hover:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 transition-colors">
        View All Results
      </button>
    </div>
  </div>
</div>

<!-- JavaScript for Dashboard Integration -->
<script src="/static/js/ml-api.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Ensure ML API is loaded
    if (typeof mlAPI === 'undefined') {
        console.error('ML API not loaded properly');
        return;
    }
    // Load predictions when the breast cancer tab is shown
    const refreshBtn = document.getElementById('dashboard-refresh-predictions');
    if (refreshBtn) {
        refreshBtn.addEventListener('click', loadDashboardPredictions);
        
        // Load predictions initially
        loadDashboardPredictions();
    }
    
    async function loadDashboardPredictions() {
        const container = document.getElementById('dashboard-predictions-container');
        
        try {
            const predictions = await mlAPI.getPredictions();
            updateDashboardPredictions(predictions);
        } catch (error) {
            container.innerHTML = '<div class="text-center py-4 text-red-500"><p>Failed to load predictions</p></div>';
        }
    }
    
    function updateDashboardPredictions(predictions) {
        const container = document.getElementById('dashboard-predictions-container');
        
        if (predictions.length === 0) {
            container.innerHTML = '<div class="text-center py-4 text-gray-500"><p>No predictions yet. Start your first analysis!</p></div>';
            return;
        }
        
        // Show only the 3 most recent predictions
        const recentPredictions = predictions.slice(0, 3);
        
        const html = '<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">' +
            recentPredictions.map(pred => `
                <div class="bg-white rounded-lg shadow p-4">
                    <div class="flex items-center justify-between mb-2">
                        <span class="text-sm font-medium text-gray-500">${new Date(pred.created_at).toLocaleDateString()}</span>
                        <span class="px-2 py-1 text-xs font-medium rounded-full ${
                            pred.prediction === 'Benign' ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'
                        }">
                            ${pred.prediction}
                        </span>
                    </div>
                    <div class="text-sm text-gray-600">
                        <p>Confidence: ${(pred.confidence * 100).toFixed(1)}%</p>
                        <p>Risk Level: ${pred.risk_level}</p>
                    </div>
                </div>
            `).join('') + '</div>';
        
        container.innerHTML = html;
    }
});
</script>
